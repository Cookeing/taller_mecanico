{% extends "base.html" %} {% load humanize %} {% block content %}
<div class="container py-4">
  <h2 class="mb-3">
    Vehículo: <span class="text-primary">{{ vehiculo.patente }}</span>
  </h2>

  <p>
    <strong>Cliente:</strong> {{ vehiculo.cliente.nombre|title }} —
    <span class="text-muted">{{ vehiculo.cliente.rut }}</span>
  </p>

  <ul class="list-unstyled mb-4">
    <li><strong>Marca:</strong> {{ vehiculo.marca|default:"-" }}</li>
    <li><strong>Modelo:</strong> {{ vehiculo.modelo|default:"-" }}</li>
    <li><strong>Año:</strong> {{ vehiculo.anio|default:"-" }}</li>
    <li><strong>Chasis:</strong> {{ vehiculo.chasis|default:"-" }}</li>
    <li><strong>Motor:</strong> {{ vehiculo.motor|default:"-" }}</li>
    <li>
      <strong>Kilometraje:</strong>
      {% if vehiculo.kilometraje %} {{ vehiculo.kilometraje|intcomma }}
      <span class="text-muted">km</span>
      {% else %}
      <span class="text-muted">-</span>
      {% endif %}
    </li>
  </ul>

  <hr />

  <h4 class="mt-4">Historial de servicios</h4>

  {% if servicios %}
  <div class="table-responsive">
    <table class="table table-striped table-bordered mt-3 align-middle">
      <thead class="table-dark">
        <tr>
          <th class="text-center">Fecha</th>
          <th>Descripción</th>
          <th class="text-center">Estado</th>
          <th class="text-end">Total</th>
        </tr>
      </thead>
      <tbody>
        {% for s in servicios %}
        <tr>
          <td class="text-center">{{ s.fecha_servicio|date:"d-m-Y" }}</td>
          <td>{{ s.descripcion_trabajo|default:"(Sin descripción)" }}</td>
          <td class="text-center">
            {% if s.estado == "proceso" %}
            <span class="badge bg-warning text-dark">En proceso</span>
            {% elif s.estado == "finalizado" %}
            <span class="badge bg-success">Finalizado</span>
            {% elif s.estado == "pendiente" %}
            <span class="badge bg-secondary">Pendiente</span>
            {% elif s.estado == "cancelado" %}
            <span class="badge bg-danger">Cancelado</span>
            {% else %}
            <span class="badge bg-light text-dark"
              >{{ s.estado|capfirst }}</span
            >
            {% endif %}
          </td>
          <td class="text-end fw-bold">
            ${{ s.total|floatformat:0|intcomma }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-muted">No hay servicios registrados para este vehículo.</p>
  {% endif %}

  <a href="{% url 'vehiculos:list' %}" class="btn btn-secondary mt-3">Volver</a>
</div>
{% endblock %}
